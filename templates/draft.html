<!DOCTYPE html>
    <head>
	    <meta charset="UTF-8">
        <meta name="author" content="Daniel Haueter">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="{{ url_for('static', path='/bootstrap.min.css') }}" rel="stylesheet">
        <link rel="icon" type="image/x-icon" href="/static/images/favicon.ico">
        <title>Draft Room</title>
        <meta content="text/html; charset=windows-1252" http-equiv="Content-Type">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
        <script src="/static/sort-table.js"></script>
        <script>
            var data = {{ json|safe }};
            //console.log(data['Joey Gallo']['playerid']);
            
            $(document).ready(function(){
                $("#projected_stats_table tr").hide();
                $("#projected_stats_table tr:first").show();
                $("input[name='playerid']").on('focusout', function(e){
                    var selected = $(this).val();
                    $("#projected_stats_table tr").hide();
                    $("#projected_stats_table tr:first").show();
                    $("#"+selected).show();
                    $.each(data, function(i, v) {
                        if (v.playerid == selected) {
                            selected_name = i
                            return;
                        }
                    });
                    radar_data = [{
                        type: 'scatterpolar',
                        r: [data[selected_name]['zBA'], data[selected_name]['zHR'], data[selected_name]['zR'], data[selected_name]['zRBI'], data[selected_name]['zSB'], data[selected_name]['zBA']],
                        theta: ['BA','HR','R', 'RBI', 'SB', 'BA'],
                        fill: 'toself'
                        }]

                        layout = {
                            height: 300,
                            polar: {
                                radialaxis: {
                                visible: true,
                                range: [-3, 3]
                                },
                            margin: { l:0, r:0, t:0, b:0, pad:0}
                        },
                        showlegend: false
                    }
                    Plotly.newPlot("radar_chart", radar_data, layout, {displayModeBar: false})
                });
                $("#button").click(function(){
                    var v = $("#player_list").val();
                    $.get("/fantasy/draft/"+v, function(data, status){
                        alert("Data: " + data + "\nStatus: " + status);
                    });
                });
                
                $("#rosterTable").on("click", "td", function() {
                    var p_name = $(this).text();
                    //console.log(p_name, "#"+data[p_name]['playerid']);
                    $("#projected_stats_table tr").hide();
                    $("#projected_stats_table tr:first").show();
                    var tr_id = data[p_name]['playerid'].toString();
                    $("#player_select").val(tr_id);
//                    alert(tr_id);
                });
            })

        </script>
    </head>
    <body>
        <div class="row">
            <div class="col-md-2">
                <form action="/fantasy/draft/update_bid" method="get">
                    <input id="player_select" list="player_list" name="playerid">
                    <datalist id="player_list">
                        {% for i, row in hitters.iterrows() %}
                            <option value="{{ row['playerid'] }}">{{ row['Name'] }}</option>
                        {% endfor %}
                    </datalist>
                    <br><br>
                    <table style="font-size:12px">
                        <tr>
                            <td>
                                <input type="radio" id="team1" name="owner" value="Avg Joes">
                                <label for="team1">Avg Joes</label>
                            </td>
                            <td>
                                <input type="radio" id="team2" name="owner" value="Brewbirds">
                                <label for="team2">Brewbirds</label>
                            </td>
                            <td>
                                <input type="radio" id="team3" name="owner" value="Charmer">
                                <label for="team3">Charmer</label>
                            </td>
                            <td>
                                <input type="radio" id="team4" name="owner" value="Dirty Birds">
                                <label for="team4">Dirty Birds</label>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input type="radio" id="team5" name="owner" value="Harvey">
                                <label for="team5">Harvey</label>
                            </td>
                            <td>
                                <input type="radio" id="team6" name="owner" value="Lil Trump">
                                <label for="team6">Lil Trump</label>
                            </td>
                            <td>
                                <input type="radio" id="team7" name="owner" value="Lima Time">
                                <label for="team7">Lima Time</label>
                            </td>
                            <td>
                                <input type="radio" id="team8" name="owner" value="Midnight">
                                <label for="team8">Midnight</label>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input type="radio" id="team9" name="owner" value="Moms Cookin">
                                <label for="team9">Mother</label>
                            </td>
                            <td>
                                <input type="radio" id="team10" name="owner" value="Roid Ragers">
                                <label for="team10">Roiders</label>
                            </td>
                            <td>
                                <input type="radio" id="team11" name="owner" value="Trouble">
                                <label for="team11">Trouble</label>
                            </td>
                            <td>
                                <input type="radio" id="team12" name="owner" value="Wu-Tang">
                                <label for="team12">Wu-Tang</label>
                            </td>
                        </tr>
                    </table>
                    <br>
                    <label for="price">Auction Price</label>
                    <input type="text" name="price" id="price_entry" size="2" placeholder="Price" value=1>
                    <button id="button">Record Bid</button>
                    <button id="update_bid">Update Bid</button>
                    <a href="/fantasy/draft/reset_all"><s>Reset</s></a>
                </form>
            </div>
            <div class="col-md-2">
                <b>Radar Chart</b>
                <div id="radar_chart"></div>
            </div>
            <div class='col-md-6'>
                <table class='table' id="projected_stats_table">
                    <thead>
                        <th>#</th>
                        <th>Name</th>
                        <th>Team</th>
                        <th>Pos</th>
                        <th>PA</th>
                        <th>BA</th>
                        <th>HR</th>
                        <th>R</th>
                        <th>RBI</th>
                        <th>SB</th>
                        <th>$</th>
                        <th>Z</th>
                    </thead>
                    {% for i, row in hitters.iterrows() %}
                        <tr id="{{ row['playerid'] }}">
                            <td>{{ row['playerid'] }}</td>
                            <td>{{ row['Name'] }}</td>
                            <td>{{ row['Team'] }}</td>
                            <td>{{ row['Pos'] }}</td>
                            <td>{{ row['PA'] }}</td>
                            <td>{{ row['AVG'] }}</td>
                            <td>{{ row['HR'] }}</td>
                            <td>{{ row['R'] }}</td>
                            <td>{{ row['RBI'] }}</td>
                            <td>{{ row['SB'] }}</td>
                            <td>{{ row['Dollars'] }}</td>
                            <td>{{ row['z'] }}</td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
        <div class="row">
            <div class="col-md-2" style="height:500px; overflow-y:scroll;">
                <h3>Draft Order</h3>
                <table style="width:100%; font-size:12px;">
                    {% for i, row in owned.sort_values('Timestamp', ascending=False).iterrows() %}
                    <tr>
                        <td>{{ row['Name'] }}</td>
                        <td>${{ row['Paid'] }}</td>
                        <td>{{ row['Owner'] }}</td>
                    </tr>
                    {% endfor %}
                </table>
            </div>
            <div class="col-md-1">
                Meter
            </div>
            <div class="col-md-9">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                      <a class="nav-link active" data-bs-toggle="tab" href="#summary">Summary</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" data-bs-toggle="tab" href="#rosters">Rosters</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" data-bs-toggle="tab" href="#chart">Chart</a>
                    </li>
                  </ul>
                  <div class="tab-content">
                    <div class="tab-pane container active" id="summary">
                        <table class="table table-condensed table-hover" id="myTable" style="font-size:12px;">
                            <thead>
                                <th onclick="sortTable(0)">Owner</th>
                                <th onclick="sortTable(1)">$ Left</th>
                                <th onclick="sortTable(2)">Z Value</th>
                                <th onclick="sortTable(3)">$/Unit</th>
                                <th onclick="sortTable(4)">Count</th>
                                <th onclick="sortTable(5)">BA</th>
                                <th onclick="sortTable(6)">HR</th>
                                <th onclick="sortTable(7)">R</th>
                                <th onclick="sortTable(8)">RBI</th>
                                <th onclick="sortTable(9)">SB</th>
                                <th onclick="sortTable(10)">Pts</th>
                                <th onclick="sortTable(11)">Rank</th>
                            </thead>
                        {% for i, row in owners_df.iterrows() %}
                            <tr>
                                <td>{{ row['Owner'] }}</td>
                                <td>{{ row['$ Left'] }}</td>
                                <td>{{ row['z'] }}</td>
                                <td>{{ row['$/unit'] }}</td>
                                <td>{{ row['Drafted'] }}</td>
                                <td>{{ row['BA'] }}</td>
                                <td>{{ row['HR'] }}</td>
                                <td>{{ row['R'] }}</td>
                                <td>{{ row['RBI'] }}</td>
                                <td>{{ row['SB'] }}</td>
                                <td>{{ row['Pts'] }}</td>
                                <td>{{ row['Rank'] }}</td>
                            </tr>
                        {% endfor %}
                        </table>
                    </div>
                    <div class="tab-pane container fade" id="rosters">
                        <table class='table table-condensed table-hover' id="rosterTable" style="font-size:10px;">
                            <thead>
                                <th>Pos</th>
                                <th>AvgJoes</th>
                                <th>Brewbirds</th>
                                <th>DB's</th>
                                <th>Charmer</th>
                                <th>Harvey</th>
                                <th>Lil T</th>
                                <th>Lima</th>
                                <th>Midnight</th>
                                <th>Mother</th>
                                <th>Ragers</th>
                                <th>Trouble</th>
                                <th>Wu-Tang</th>
                            </thead>
                            {% for i, row in roster.iterrows() %}
                                <tr>
                                    <td>{{ i }}</td>
                                    <td>{{ row['Avg Joes'] }}</td>
                                    <td>{{ row['Brewbirds'] }}</td>
                                    <td>{{ row['Dirty Birds'] }}</td>
                                    <td>{{ row['Charmer'] }}</td>
                                    <td>{{ row['Harvey'] }}</td>
                                    <td>{{ row['Lil Trump'] }}</td>
                                    <td>{{ row['Lima Time'] }}</td>
                                    <td>{{ row['Midnight'] }}</td>
                                    <td>{{ row['Moms Cookin'] }}</td>
                                    <td>{{ row['Roid Ragers'] }}</td>
                                    <td>{{ row['Trouble'] }}</td>
                                    <td>{{ row['Wu-Tang'] }}</td>
                                </tr>
                            {% endfor %}
                        </table>
                    </div>
                    <div class="tab-pane container fade" id="chart">
                        <h3>Chart</h3>
                        <p>Add Plotly charts</p>
                        <p>
                            
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
